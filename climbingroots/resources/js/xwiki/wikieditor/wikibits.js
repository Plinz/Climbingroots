var noOverwrite=false;var alertText;var clientPC=navigator.userAgent.toLowerCase();var is_gecko=((clientPC.indexOf("gecko")!=-1)&&(clientPC.indexOf("spoofer")==-1)&&(clientPC.indexOf("khtml")==-1)&&(clientPC.indexOf("netscape/7.0")==-1));var is_safari=((clientPC.indexOf("AppleWebKit")!=-1)&&(clientPC.indexOf("spoofer")==-1));function addButton(e,a,c,b,d){a=escapeQuotes(a);c=escapeQuotes(c);b=escapeQuotes(b);d=escapeQuotes(d);document.write('<a href="javascript:insertTags');document.write("('"+c+"','"+b+"','"+d+"');\">");document.write('<img src="'+e+'" border="0" ALT="'+a+'" TITLE="'+a+'">');document.write("</a>");return}function escapeQuotes(b){var a=new RegExp("'","g");b=b.replace(a,"\\'");a=new RegExp('"',"g");b=b.replace(a,"&quot;");a=new RegExp("\\n","g");b=b.replace(a,"\\n");return b}function insertTags(i,a,b){var m=($("edit")&&$("edit").content)||$("content");if(document.selection&&!is_gecko){var n=document.selection.createRange().text;if(!n){n=b}m.focus();if(n.charAt(n.length-1)==" "){n=n.substring(0,n.length-1);document.selection.createRange().text=i+n+a+" "}else{document.selection.createRange().text=i+n+a}}else{if(m.selectionStart||m.selectionStart=="0"){var j=m.selectionStart;var c=m.selectionEnd;var e=m.scrollTop;var d=(m.value).substring(j,c);if(!d){d=b}if(d.charAt(d.length-1)==" "){subst=i+d.substring(0,(d.length-1))+a+" "}else{subst=i+d+a}var l=m.value.substring(0,j);var k=m.value.substring(c,m.value.length);m.value=l+subst+k;m.focus();var p=j+(i.length+d.length+a.length);m.selectionStart=p;m.selectionEnd=p;m.scrollTop=e}else{var h=alertText;var g=new RegExp("\\$1","g");var f=new RegExp("\\$2","g");h=h.replace(g,b);h=h.replace(f,i+b+a);var o;if(b){o=prompt(h)}else{o=""}if(!o){o=b}o=i+o+a;if(!is_safari){m.focus()}noOverwrite=true}}if(m.createTextRange){m.caretPos=document.selection.createRange().duplicate()}};